// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

enum DishTypeEnum {
    BREAKFAST
    LUNCH
    DINNER
    DESSERT
    SNACK
}

enum RestrictionEnum {
    GLUTEN
    LACTOSE
    EGG
}

enum AllergenEnum {
    GLUTEN
    DAIRY
    PEANUTS
    TREE_NUTS
    SOY
    SHELLFISH
    FISH
    EGGS
    PEANUT
    TREE_NUT
    EGG
    WHEAT
}

enum CuisineEnum {
    GLOBAL
    AFRICAN
    CHINESE
    JAPANESE
    KOREAN
    VIETNAMESE
    THAI
    INDIAN
    BRITISH
    IRISH
    FRENCH
    ITALIAN
    MEXICAN
    SPANISH
    MIDDLE_EASTERN
    JEWISH
    AMERICAN
    CAJUN
    SOUTHERN
    GREEK
    GERMAN
    NORDIC
    EASTERN_EUROPEAN
    CARIBBEAN
    LATIN_AMERICAN
}

model User {
    id       String   @id @default(cuid())
    email    String   @unique
    password String
    recipes  Recipe[]
}

model Recipe {
    id           String        @id @default(cuid())
    title        String
    description  String
    createdBy    User          @relation(fields: [createdById], references: [id])
    createdById  String
    createdAt    DateTime      @default(now())
    cookTime     String
    ingredients  Ingredient[]
    instructions Instruction[]
    restrictions Restriction[]
    cuisine      CuisineEnum
    dishType     DishType[]
    allergens    Allergen[]
    vegan        Boolean
    rating       Float
}

model Restriction {
    id       String          @id @default(cuid())
    name     RestrictionEnum @unique
    recipeId String
    recipe   Recipe          @relation(fields: [recipeId], references: [id])

    @@index([recipeId], name: "restriction_recipeId")
}

model Ingredient {
    id       String @id @default(cuid())
    amount   String
    name     String
    recipeId String
    recipe   Recipe @relation(fields: [recipeId], references: [id])

    @@index([recipeId], name: "ingredient_recipeId")
}

model Instruction {
    id       String @id @default(cuid())
    step     Int
    text     String
    recipeId String
    recipe   Recipe @relation(fields: [recipeId], references: [id])

    @@index([recipeId], name: "instruction_recipeId")
}

model DishType {
    id       String       @id @default(cuid())
    name     DishTypeEnum @unique
    recipeId String
    recipe   Recipe       @relation(fields: [recipeId], references: [id])

    @@index([recipeId], name: "dishType_recipeId")
}

model Allergen {
    id       String       @id @default(cuid())
    name     AllergenEnum @unique
    recipeId String
    recipe   Recipe       @relation(fields: [recipeId], references: [id])

    @@index([recipeId], name: "allergen_recipeId")
}

model Example {
    id        String   @id @default(cuid())
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
}
